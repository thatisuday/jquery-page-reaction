{"version":3,"sources":["plugin.js"],"names":["$","undefined","window","io","Error","getPickData","$elem","attrs","data","forEach","attr","value","socketEmit","socket","callback","emit","fn","pageReact","options","extend","on","once","pickData","this","each","$this","dispatchEvent","event","sessionId","bindDomEvents","document","ready","one","jQuery"],"mappings":"AAAA,cAEA,SAAAA,GAGA,GAAAC,QAAAC,OAAAC,IAAA,MAAAD,OAAAC,GACA,KAAA,IAAAC,OAAA,sEAOA,IAAAC,GAAA,SAAAC,EAAAC,GACA,GAAAC,KAUA,OARAD,GAAAE,QAAA,SAAAC,GACA,GAAAC,GAAAL,EAAAE,KAAAE,EAEAC,KACAH,EAAAE,GAAAC,KAIAH,GAIAI,EAAA,SAAAC,EAAAL,EAAAM,GACAD,EAAAE,KAAA,cAAAP,GACAM,EAAAN,GAMAR,GAAAgB,GAAAC,UAAA,SAAAC,GAGA,GAAAA,GAAAlB,EAAAmB,WACAC,GAAA,QACAC,MAAA,EACAC,aACAJ,EAKA,IAAAjB,QAAAiB,EAAAL,QAAA,MAAAK,EAAAL,OACA,KAAA,IAAAT,OAAA,8DAAAc,EAAAE,GAgFA,OAzEAG,MAAAC,KAAA,WAGA,GAAAC,GAAAzB,EAAAuB,MAKAG,EAAA,SAAAC,EAAAb,GACAF,EAAAM,EAAAL,QACAc,MAAAA,EACAC,UAAAV,EAAAU,UACAN,SAAAjB,EAAAoB,EAAAP,EAAAI,WACAR,IAIAe,EAAA,SAAAF,EAAAb,GACA,SAAAa,EACA3B,EAAA8B,UAAAC,MAAA,WACAjB,EAAAa,KAIA,GAAAT,EAAAG,KACAI,EAAAO,IAAAL,EAAA,WACAb,EAAAa,KAIAF,EAAAL,GAAAO,EAAA,WACAb,EAAAa,KASA,UAAAT,EAAAE,GACAS,EAAA,QAAA,SAAAF,GACAD,EAAAC,EAAA,SAAAnB,GACAU,EAAAJ,UAAAI,EAAAJ,SAAAW,EAAAjB,OAKA,cAAAU,EAAAE,GACAS,EAAA,aAAA,SAAAF,GACAD,EAAAC,EAAA,SAAAnB,GACAU,EAAAJ,UAAAI,EAAAJ,SAAAW,EAAAjB,OAKA,UAAAU,EAAAE,GACAS,EAAA,SAAA,SAAAF,GACAD,EAAAC,EAAA,SAAAnB,GACAU,EAAAJ,UAAAI,EAAAJ,SAAAW,EAAAjB,OAKA,SAAAU,EAAAE,IACAS,EAAA,QAAA,SAAAF,GACAD,EAAAC,EAAA,SAAAnB,GACAU,EAAAJ,UAAAI,EAAAJ,SAAAW,EAAAjB,SAMAe,OAEAU","file":"plugin.min.js","sourcesContent":["'use strict';\r\n\r\n(function($){\r\n\r\n\t// check if socket.io client library is loaded\r\n\tif(window.io == undefined || window.io == null){\r\n\t\tthrow new Error('socket-io client library is missing!!! page-reaction will not work!');\r\n\t\treturn;\r\n\t}\r\n\r\n\t/*****************************************************************/\r\n\r\n\t// get data from html data attributes\r\n\tvar getPickData = function($elem, attrs){\r\n\t\tvar data = {};\r\n\r\n\t\tattrs.forEach(function(attr){\r\n\t\t\tvar value = $elem.data(attr);\r\n\t\t\t\r\n\t\t\tif(value){\r\n\t\t\t\tdata[attr] = value;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn data;\r\n\t}\r\n\r\n\t// emit interaction event to socket server\r\n\tvar socketEmit = function(socket, data, callback){\r\n\t\tsocket.emit('interaction', data);\r\n\t\tcallback(data);\r\n\t}\r\n\r\n\t/*****************************************************************/\r\n\r\n\t// inject page-reaction plugin to jQuery\r\n\t$.fn.pageReact = function(options){\r\n\r\n\t\t// set options\r\n\t\tvar options = $.extend({}, {\r\n\t\t\ton \t\t\t:  'click',\r\n\t\t\tonce \t\t:  true,\r\n\t\t\tpickData \t: [],\r\n\t\t}, options);\r\n\r\n\t\t/*****************************************/\r\n\r\n\t\t// check if web-socket connection is injected\r\n\t\tif(options.socket == undefined || options.socket == null){\r\n\t\t\tthrow new Error('socket connection is missing in options provided for event ' + options.on);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t/*****************************************/\r\n\r\n\t\t// loop over all selector elements\r\n\t\tthis.each(function(){\r\n\t\t\t\r\n\t\t\t// pick single element from selection\r\n\t\t\tvar $this = $(this);\r\n\r\n\t\t\t/***************************/\r\n\r\n\t\t\t// Dispatch interaction event to socket server\r\n\t\t\tvar dispatchEvent = function(event, callback){\r\n\t\t\t\tsocketEmit(options.socket, {\r\n\t\t\t\t\tevent \t\t: \tevent,\r\n\t\t\t\t\tsessionId \t: \toptions.sessionId,\r\n\t\t\t\t\tpickData \t: \tgetPickData($this, options.pickData)\r\n\t\t\t\t}, callback);\r\n\t\t\t}\r\n\r\n\t\t\t// bind events to dom elements\r\n\t\t\tvar bindDomEvents = function(event, callback){\r\n\t\t\t\tif(event == 'ready'){\r\n\t\t\t\t\t$(document).ready(function(){\r\n\t\t\t\t\t\tcallback(event);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tif(options.once == true){\r\n\t\t\t\t\t\t$this.one(event, function(){\r\n\t\t\t\t\t\t\tcallback(event);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\t$this.on(event, function(){\r\n\t\t\t\t\t\t\tcallback(event);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t/***************************/\r\n\r\n\t\t\t// when user clicks on an element\r\n\t\t\tif(options.on == 'click'){\r\n\t\t\t\tbindDomEvents('click', function(event){\r\n\t\t\t\t\tdispatchEvent(event, function(data){\r\n\t\t\t\t\t\tif(options.callback) options.callback($this, data);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t// when user enter mouse inside element\r\n\t\t\telse if(options.on == 'mouseenter'){\r\n\t\t\t\tbindDomEvents('mouseenter', function(event){\r\n\t\t\t\t\tdispatchEvent(event, function(data){\r\n\t\t\t\t\t\tif(options.callback) options.callback($this, data);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t// when element is in view\r\n\t\t\telse if(options.on == 'inview'){\r\n\t\t\t\tbindDomEvents('inview', function(event){\r\n\t\t\t\t\tdispatchEvent(event, function(data){\r\n\t\t\t\t\t\tif(options.callback) options.callback($this, data);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t// when document is ready\r\n\t\t\telse if(options.on == 'ready'){\r\n\t\t\t\tbindDomEvents('ready', function(event){\r\n\t\t\t\t\tdispatchEvent(event, function(data){\r\n\t\t\t\t\t\tif(options.callback) options.callback($this, data);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn this;\r\n\t}\r\n})(jQuery);"]}